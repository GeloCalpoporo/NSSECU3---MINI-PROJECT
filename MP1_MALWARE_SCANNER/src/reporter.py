import json
from pathlib import Path

class ScanReporter:
    @staticmethod
    def save_json(results, filepath):
        with open(filepath, 'w') as f:
            json.dump(results, f, indent=2)
    
    @staticmethod
    def save_csv(results, filepath):
        with open(filepath, 'w') as f:
            f.write("Filename,Path,FileType,MD5,SHA1,Malicious\n")
            for r in results:
                f.write(f"{r['filename']},{r['path']},{r['file_type'].get('description','')},{r['hashes'].get('md5','')},{r['hashes'].get('sha1','')},{r['is_malicious']}\n")